# –ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä—Ç—Ç–µ—Ä–Ω–æ–º CDC, –∏—Å–ø–æ–ª—å–∑—É—è Postgres-Kafka-Debezium.

## üíª –ß—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Debezium –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CDC –ø–∞—Ç—Ç–µ—Ä–Ω–∞. 
–í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Postgres, –∞ –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Debezium —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å Kafka.
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

- ‚úîÔ∏è Docker - –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.
- ‚úîÔ∏è Kafka + ZooKeeper - –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –±—Ä–æ–∫–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π. 1 broker, 1 zookeeper.
- ‚úîÔ∏è Debezium –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –¥–ª—è CDC. –û–Ω –∂–µ Kafka Connect worker –¥–ª—è CDC.
- ‚úîÔ∏è Confluent Control Center - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Kafka –∫–ª–∞—Å—Ç–µ—Ä–∞.
- ‚úîÔ∏è Debezium UI - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞–º–∏ Debezium.
- ‚úîÔ∏è Postgres - –¥–≤–µ –ë–î. –ü–µ—Ä–≤–∞—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –≥–¥–µ –±—É–¥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ. –í—Ç–æ—Ä–∞—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ü–µ–ª–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.
- ‚úîÔ∏è DuckDB - –¥–ª—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —Å DB Postgres.
- ‚úîÔ∏è Python - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∏–∑ Kafka –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ.
- ‚úîÔ∏è UV - –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `main.py` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞.
–í `generate.py` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã - INSERT/UPDATE/DELETE.
–í `consumer.py` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω Kafka consumer, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka topic –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã. –ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é –∏–∑–º–µ–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ.

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
- ‚úîÔ∏è –°–æ–∑–¥–∞—é—Ç—Å—è —Å—Ö–µ–º–∞ –∏ —Ç–∞–±–ª–∏—Ü–∞ –≤ —Ü–µ–ª–µ–≤–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- ‚úîÔ∏è –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ - INSERT/UPDATE/DELETE.
- ‚úîÔ∏è Debezium –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —Ç–æ–ø–∏–∫–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü–µ.
- ‚úîÔ∏è Consumer –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –∑–∞–±–∏—Ä–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–æ–ø–∏–∫–∞.
- ‚úîÔ∏è –í python —Å–∫—Ä–∏–ø—Ç–µ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é –≥–µ–Ω–µ—Ä–∏—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ INSERT/UPDATE/DELETE –≤ —Ü–µ–ª–µ–≤–æ–π –ë–î.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
Project-4-Debezium/
‚îÇ
‚îú‚îÄ‚îÄ app/                       # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ consumer/              # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π Kafka
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ consumer.py        # Kafka consumer –¥–ª—è —Ç–æ–ø–∏–∫–æ–≤ Debezium –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤ —Ü–µ–ª–µ–≤–æ–π DB
‚îÇ   ‚îú‚îÄ‚îÄ utils/                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate.py        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–ø–∏—Å–µ–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–π DB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ postgres.py        # –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py           # –û–±—â–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ main.py                # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose (Postgres, Kafka, Debezium, UI)
‚îú‚îÄ‚îÄ register-postgres.json     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ Debezium –¥–ª—è PostgreSQL
‚îú‚îÄ‚îÄ pyproject.toml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Python-–ø—Ä–æ–µ–∫—Ç–∞ / –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ uv.lock                    # Lock-—Ñ–∞–π–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
‚îî‚îÄ‚îÄ README.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
git clone https://github.com/KimAleksey/Debezium-CDC-Kafka.git
cd Debezium-CDC-Kafka
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```
–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª.

–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ—Ç–∫–∞
```bash
cd Debezium-CDC-Kafka
```

–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
uv venv
```

–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
source .venv/bin/activate
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
uv sync
```

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
```
–ï—Å–ª–∏ –º–µ–Ω—è–ª–∏ –ø–æ—Ä—Ç—ã –≤ Docker-compose - –ø–æ–º–µ–Ω—è–π—Ç–µ –∏ –≤ .env —Ñ–∞–π–ª–µ.

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
docker compose up -d
```

### –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
curl -i -X POST -H "Accept:application/json" -H  "Content-Type:application/json" http://localhost:8083/connectors/ -d @register-postgres.json
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã

```bash
python3 -m app.main
```

## üßë‚Äçüíª–†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º

### –†–∞–±–æ—Ç–∞ —Å Debezium (Kafka).

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ http://localhost:9021/.

![img.png](docs/img.png)

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ø–∏–∫ dbserver1.inventory.customers.

![img_1.png](docs/img_1.png)

3. –£–≤–∏–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è.

![img_2.png](docs/img_2.png)

4. –í –∫–æ–Ω—Å–æ–ª–∏ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤–æ—Ç —Ç–∞–∫–æ–π –ª–æ–≥:

```text
2026-01-18 22:06:57,713 | INFO | root | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ü–µ–ª–µ–≤–æ–º—É Postgres DB.
2026-01-18 22:06:57,743 | INFO | root | POSTGRES_HOST_TRG: localhost
2026-01-18 22:06:57,743 | INFO | root | POSTGRES_PORT_TRG: 5435
2026-01-18 22:06:57,744 | INFO | root | POSTGRES_DB_TRG: postgres
2026-01-18 22:06:57,764 | INFO | root | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Postgres —É—Å–ø–µ—à–Ω–æ.
2026-01-18 22:06:57,774 | INFO | root | –°—Ö–µ–º–∞ inventory —Å–æ–∑–¥–∞–Ω–∞.
2026-01-18 22:06:57,775 | INFO | root | –¢–∞–±–ª–∏—Ü–∞ inventory.customers —Å–æ–∑–¥–∞–Ω–∞.
2026-01-18 22:06:57,871 | INFO | root | KAFKA_USERS_COORDINATES_TOPIC: dbserver1.inventory.customers
2026-01-18 22:06:57,871 | INFO | root | KAFKA_BOOTSTRAP_SERVER: localhost:9092
2026-01-18 22:06:57,954 | INFO | root | –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—É—Å—Ç—ã–º Value. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
2026-01-18 22:06:57,961 | INFO | root | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Postgres —É—Å–ø–µ—à–Ω–æ.
2026-01-18 22:06:57,961 | INFO | root | Start execution.
2026-01-18 22:06:57,979 | INFO | root | Insert SQL: 
        INSERT INTO pg_src.inventory.customers (first_name, last_name, email)
        VALUES('–ï—Ñ–∏–º', '–ö–æ–º–∞—Ä–æ–≤', 'rbaranova@example.org');
```

5. –í DBeaver –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ Postgres –∫–∞–∫ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É, —Ç–∞–∫ –∏ –∫ —Ü–µ–ª–∏ - –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –∑–∞–ø–∏—Å–∏ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü —Å–æ–≤–ø–∞–¥–∞—é—Ç.

![img_3.png](docs/img_3.png)

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É

#### utils.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres.

#### postgres.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–∞–∫ DDL, —Ç–∞–∫ –∏ DML –≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–π –±–∞–∑–µ.
–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DuckDB:

```python
# –ü–æ–¥–∫–ª—é—á–∞–µ–º DuckDB
con = duckdb.connect()

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω—É–∂–Ω—ã—Ö –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤
con.execute("""
    INSTALL postgres; 
    LOAD postgres;
""")

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Postgres
con.execute(f"""
ATTACH 
    'host={conn_params["host"]} 
     port={conn_params["port"]} 
     user={conn_params["user"]} 
     password={conn_params["password"]} 
     dbname={conn_params["database"]}' 
AS {alias} (TYPE postgres);
""")
```

–î–∞–ª–µ–µ —ç—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Postgres.

#### generate.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Faker –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

–î–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```python
record = {
    "first_name": first_name,
    "last_name": last_name,
    "email": email,
}
```

–°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞–∑ –≤ 5 —Å–µ–∫—É–Ω–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö - INSERT/UPDATE/DELETE.
–¢–∞–±–ª–∏—Ü–∞ –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è - –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ —É Debezium.
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ WAL –≤ Kafka topic –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π.


#### consumer.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ topic –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ.

1. –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ topic.
2. –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ.
3. –í —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤ –ø–æ–ª–µ op - –ª–µ–∂–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏—è.

> Debezium –ø—Ä–∏—Å—ã–ª–∞–µ—Ç 3 —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:
> 1. **Insert** ‚Üí after –∑–∞–ø–æ–ª–Ω–µ–Ω–æ, before = null
> 2. **Update** ‚Üí –∏ before, –∏ after –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
> 3. **Delete** ‚Üí before –∑–∞–ø–æ–ª–Ω–µ–Ω–æ, after = null

4. –î–∞–ª–µ–µ —Å –ø–æ–º–æ—â—å—é DuckDB –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–∞–∫–∞—è –∂–µ –æ–ø–µ—Ä–∞—Ü–∏—è –≤ —Ü–µ–ª–µ–≤–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
5. –í –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ —Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Topic.

–î–ª—è —ç—Ç–æ–≥–æ:
> - –î–µ–ª–∞–µ–º poll –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.
> - poll(timeout) –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Kafka.
> - –ü–∞—Ä–∞–º–µ—Ç—Ä 1.0 = —Ç–∞–π–º-–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, —Ç–æ –µ—Å—Ç—å poll –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ—Ç. 
> - –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç –ø–æ—Å–ª–µ —Ç–∞–π–º-–∞—É—Ç–∞, poll –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None.
> - –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ —É—Å–µ–ø–µ—à–Ω–æ, —Ç–æ –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–∞ –∂–µ –æ–ø–µ—Ä–∞—Ü–∏—è, —á—Ç–æ –∏ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ.